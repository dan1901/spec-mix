#!/bin/sh
# Pre-commit hook for markdown linting

echo "ğŸ” Running markdown lint check..."

# Check if markdownlint-cli2 is installed
if ! command -v markdownlint-cli2 &> /dev/null; then
    echo "âš ï¸  markdownlint-cli2 is not installed. Trying npx..."

    # Try using npx
    if command -v npx &> /dev/null; then
        npx markdownlint-cli2 '**/*.md'
        LINT_EXIT=$?
    else
        echo "âŒ Please install markdownlint-cli2:"
        echo "   npm install -g markdownlint-cli2"
        echo "   or"
        echo "   npm install (if package.json exists)"
        exit 1
    fi
else
    # Run markdownlint
    markdownlint-cli2 '**/*.md'
    LINT_EXIT=$?
fi

if [ $LINT_EXIT -ne 0 ]; then
    echo "âŒ Markdown lint check failed!"
    echo "ğŸ“ To fix automatically, run: npm run lint:fix"
    echo "ğŸ“ Or manually fix the issues above"
    exit 1
fi

echo "âœ… Markdown lint check passed!"
exit 0