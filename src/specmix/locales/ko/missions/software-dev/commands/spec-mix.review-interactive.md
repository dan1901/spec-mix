---
description: for_review 레인의 작업에 대한 대화형 가이드 리뷰 프로세스
---

## 사용자 입력

```text

$ARGUMENTS

```

진행하기 전에 사용자 입력을 **반드시** 고려해야 합니다(비어있지 않은 경우).

## 개요

이 명령은 `for_review` 레인의 작업에 대한 **대화형 가이드 리뷰 경험**을 제공합니다. 수동 리뷰 대신 AI 어시스턴트가 각 작업을 체계적으로 안내하고, 구조화된 리뷰 피드백 작성을 돕고, 작업 상태를 자동으로 업데이트합니다.

## `/spec-mix.review`와의 주요 차이점

| 기능 | `/spec-mix.review` | `/spec-mix.review-interactive` |
|---------|-------------------|-------------------------------|
| 리뷰 모드 | 자동/수동 | 가이드 대화형 |
| 피드백 형식 | AI 생성 또는 수동 | 단계별 구조화된 양식 |
| 사용자 상호작용 | 최소 | 높음 (Q&A 스타일) |
| 리뷰 문서 | 선택적 | 항상 생성됨 |
| 최적 용도 | 빠른 일괄 리뷰 | 상세하고 철저한 리뷰 |

## 실행 흐름

### 1. 기능 디렉토리 식별

```bash
# 브랜치 또는 디렉토리에서 현재 기능 감지
FEATURE=$(bash .spec-mix/scripts/bash/common.sh get_current_branch)

# 또는 사용자 제공 기능 사용
FEATURE="001-feature-name"
```

기능을 찾지 못한 경우 사용자에게 지정하도록 요청합니다.

### 2. for_review에서 작업 스캔

```bash
ls specs/{feature}/tasks/for_review/*.md
```

**작업이 없는 경우**:
- 사용자에게 알림: "현재 for_review 레인에 작업이 없습니다"
- `doing` 레인 확인 또는 `/spec-mix.implement` 실행 제안
- 종료

**작업을 찾은 경우**:
- 간략한 요약과 함께 모든 작업 나열
- 사용자에게 질문: "어떤 작업을 리뷰하시겠습니까? (또는 모든 작업을 리뷰하려면 'all' 입력)"

### 3. 선택한 각 작업에 대해

#### 단계 3.1: 작업 컨텍스트 로드

Work Package 파일 읽기:

```bash
cat specs/{feature}/tasks/for_review/WPxx.md
```

사용자에게 표시:
- 작업 ID 및 제목
- 수락 기준
- Git 히스토리 (사용 가능한 경우)
- 활동 로그 요약

#### 단계 3.2: 리뷰 질문 가이드

사용자에게 다음 질문을 **하나씩** 하고 응답 수집:

**질문 1: 수락 기준**
```
수락 기준을 검토하겠습니다. 각 기준에 대해 다음을 입력하세요:
- ✅ 충족됨
- ❌ 충족 안 됨
- ⚠️ 부분적으로 충족됨

기준 1: [설명]
평가: _____

기준 2: [설명]
평가: _____

...
```

**질문 2: 코드 품질**
```
코드 품질을 1-5 척도로 평가한다면?
1 = 나쁨 (주요 리팩토링 필요)
2 = 평균 이하 (여러 문제)
3 = 수용 가능 (사소한 개선 필요)
4 = 좋음 (기준 충족)
5 = 우수함 (모범 사례)

평가: _____

이 구현의 강점은 무엇입니까? (2-3가지 나열)
1. _____
2. _____
3. _____
```

**질문 3: 발견된 문제**
```
해결해야 할 문제를 발견하셨습니까? (yes/no)

yes인 경우 각 문제에 대해:
  - 문제 제목: _____
  - 심각도: [Critical/Major/Minor]
  - 위치: [파일:줄 또는 섹션]
  - 설명: _____
  - 필요한 조치: _____

문제 나열을 완료하면 'done' 입력
```

**질문 4: 테스팅**
```
이 구현에 대한 적절한 테스트가 있습니까? (yes/no/partial)

no 또는 partial인 경우, 어떤 테스트가 누락되었습니까? _____
```

**질문 5: 문서**
```
문서가 완전하고 최신 상태입니까? (yes/no/partial)

no 또는 partial인 경우, 무엇을 문서화해야 합니까? _____
```

**질문 6: 보안 및 성능**
```
보안 취약점을 발견하셨습니까? (yes/no)
yes인 경우, 설명: _____

성능 문제를 발견하셨습니까? (yes/no)
yes인 경우, 설명: _____
```

#### 단계 3.3: 리뷰 결정 생성

응답을 기반으로:

```
피드백을 기반으로 다음을 권장합니다:

[X] APPROVED - 모든 기준 충족, 사소하거나 문제 없음
[ ] CHANGES REQUESTED - 중요/주요 문제 발견 또는 여러 기준 충족 안 됨

이 권장사항에 동의하십니까? (yes/no)
no인 경우, 어떤 결정을 선호하십니까? _____
```

#### 단계 3.4: 리뷰 피드백 문서 생성

`review-feedback-template.md`를 사용하여 모든 응답 채우기:

```bash
# 리뷰 피드백 문서 생성
cat specs/{feature}/tasks/for_review/review-feedback-template.md | \
    sed "s/\[TASK_ID\]/$TASK_ID/g" | \
    sed "s/\[REVIEWER_NAME\]/$USER_NAME/g" | \
    # ... 모든 템플릿 자리 표시자 채우기
    > specs/{feature}/tasks/for_review/WPxx-review-feedback.md
```

생성된 문서를 사용자에게 표시:
```
다음 리뷰 피드백 문서를 생성했습니다.
올바른지 검토하고 확인해주세요.

[생성된 문서 표시]

다음 중 선택하세요:
1. 승인 및 진행
2. 문서 수동 편집
3. 이 리뷰 취소

선택: _____
```

#### 단계 3.5: Work Package 활동 로그 업데이트

WP 파일에 구조화된 리뷰 피드백 추가:

```bash
# 타임스탬프 생성
TIMESTAMP=$(date -u +%Y-%m-%dT%H:%M:%SZ)

# 리뷰 피드백 추가
echo "" >> specs/{feature}/tasks/for_review/WPxx.md
echo "## 리뷰 피드백" >> specs/{feature}/tasks/for_review/WPxx.md
echo "" >> specs/{feature}/tasks/for_review/WPxx.md

# APPROVED의 경우
if [[ $DECISION == "APPROVED" ]]; then
    echo "- $TIMESTAMP: [REVIEW] APPROVED by $REVIEWER_NAME" >> ...
    echo "  - ✅ 모든 수락 기준 충족 ($CRITERIA_MET/$CRITERIA_TOTAL)" >> ...
    echo "  - ✅ 코드 품질 평가 $QUALITY_RATING/5" >> ...
    # ... 모든 긍정적인 포인트 추가
fi

# CHANGES REQUESTED의 경우
if [[ $DECISION == "CHANGES_REQUESTED" ]]; then
    echo "- $TIMESTAMP: [REVIEW] CHANGES REQUESTED by $REVIEWER_NAME" >> ...
    # ... 모든 문제 추가
    # ... 긍정적인 포인트 추가
    echo "  - 다음 단계: $NEXT_STEPS_SUMMARY" >> ...
fi
```

#### 단계 3.6: 작업을 적절한 레인으로 이동

**APPROVED인 경우**:
```bash
.spec-mix/scripts/bash/move-task.sh WPxx for_review done specs/{feature}
```

**CHANGES REQUESTED인 경우**:
```bash
.spec-mix/scripts/bash/move-task.sh WPxx for_review doing specs/{feature}
```

#### 단계 3.7: tasks.md 업데이트

작업이 승인된 경우, `tasks.md`에서 완료로 표시:

```bash
# 작업 상태 업데이트
sed -i "s/- \[ \] WPxx:/- [x] WPxx:/" specs/{feature}/tasks.md
```

#### 단계 3.8: 다음 작업 질문

```
작업 WPxx 리뷰 완료!

결정: [APPROVED/CHANGES REQUESTED]
이동됨: [done/doing] 레인

다음 작업을 리뷰하시겠습니까? (yes/no)
```

### 4. 최종 요약

모든 리뷰가 완료된 후:

```markdown
# 리뷰 세션 요약

**기능**: {feature-name}
**리뷰어**: {reviewer-name}
**날짜**: {date}

## 리뷰된 작업

### ✅ 승인됨 (done으로 이동)
- WP01: 작업 제목 1
- WP03: 작업 제목 3

### 🔄 변경 요청됨 (doing으로 되돌림)
- WP02: 작업 제목 2 (문제: 테스트 커버리지, 문서)
- WP04: 작업 제목 4 (문제: 오류 처리)

## 진행률
- 리뷰됨: 4개 작업
- 승인됨: 2개 작업 (50%)
- 변경 필요: 2개 작업 (50%)
- for_review에 남은 작업: 0개

## 다음 단계
1. WP02 및 WP04에 대한 피드백 처리
2. 준비되면 다시 리뷰 제출
3. 모든 작업이 승인되면 최종 승인을 위해 `/spec-mix.accept` 실행
```

## 사용자 경험 향상

### 진행 상황 추적

다중 작업 리뷰 중 진행 상황 표시:

```
[5개 중 2번째 작업] WP02 리뷰 중: 사용자 인증
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 40%

✅ WP01 - 승인됨
➡️  WP02 - 진행 중
⏳ WP03 - 대기 중
⏳ WP04 - 대기 중
⏳ WP05 - 대기 중
```

### 스마트 기본값

일반적인 시나리오에 대해 스마트 기본값 제공:

```
모든 수락 기준이 충족되고(✅), 문제가 발견되지 않았으며, 코드 품질이 4/5로 평가되었습니다.

이 작업을 자동 승인하시겠습니까? (yes/no)
yes인 경우, 표준 승인 피드백을 생성하겠습니다.
no인 경우, 상세한 리뷰 질문을 계속하겠습니다.
```

### 심각도별 리뷰 템플릿

일반적인 리뷰 결과에 대한 빠른 템플릿 제공:

```
리뷰 속도를 높이는 데 도움을 드리겠습니다. 템플릿을 선택하세요:

1. 빠른 승인 - 모두 좋음, 표준 승인
2. 사소한 조정 - 작은 문제, 제안과 함께 승인
3. 주요 재작업 - 중요한 문제, doing으로 돌려보냄
4. 사용자 정의 리뷰 - 전체 가이드 리뷰 (복잡한 작업에 권장)

선택: _____
```

## 대시보드와의 통합

대시보드는 다음을 표시합니다:
- 각 작업에 대한 리뷰 히스토리 타임라인
- 리뷰어 이름 및 결정
- 작업 전반의 문제 추세
- 리뷰 속도 메트릭

시각화는 `/spec-mix.dashboard`를 참조하세요.

## 모범 사례

1. **정기적으로 리뷰**: for_review에 작업이 쌓이지 않도록 합니다
2. **구체적으로**: 정확한 파일 위치와 명확한 조치 항목을 제공합니다
3. **비평 균형**: 문제와 함께 항상 긍정적인 점을 강조합니다
4. **패턴 추적**: 여러 작업에 유사한 문제가 있는 경우 헌장 또는 계획 업데이트를 고려합니다
5. **대시보드 사용**: 리뷰 히스토리 및 추세를 시각화합니다

## 예시 세션

```
사용자: /spec-mix.review-interactive

AI: 기능 001-user-authentication의 for_review 레인에서 3개 작업을 찾았습니다:
    - WP01: 로그인 엔드포인트 구현
    - WP02: 비밀번호 재설정 플로우 추가
    - WP03: 사용자 프로필 API 생성

    어떤 작업을 리뷰하시겠습니까? (1-3, 또는 'all')

사용자: all

AI: 좋습니다! WP01부터 시작하겠습니다: 로그인 엔드포인트 구현

    [작업 세부사항, 수락 기준, git 히스토리 표시]

    수락 기준을 검토하겠습니다. 각 기준에 대해 충족되면 ✅, 충족 안 되면 ❌ 입력:

    1. POST /api/login 엔드포인트가 이메일과 비밀번호를 받음
    평가:

사용자: ✅

AI: 2. 인증 성공 시 JWT 토큰 반환
    평가:

사용자: ✅

AI: 3. 잘못된 자격 증명에 대해 401 반환
    평가:

사용자: ✅

AI: 우수합니다! 모든 3개 수락 기준이 충족되었습니다.

    코드 품질을 1-5 척도로 평가한다면?

사용자: 4

AI: 좋은 평가입니다! 이 구현의 강점은 무엇입니까? (2-3가지 나열)

사용자:
1. 적절한 상태 코드를 사용한 깔끔한 오류 처리
2. OpenAPI 스펙이 있는 잘 문서화된 API
3. bcrypt를 사용한 안전한 비밀번호 해싱

AI: 해결해야 할 문제를 발견하셨습니까? (yes/no)

사용자: yes

AI: 문제 #1:
    문제 제목:

사용자: 속도 제한 누락

AI: 심각도: [Critical/Major/Minor]

사용자: Major

AI: 위치: [파일:줄 또는 섹션]

사용자: src/api/auth.py:login 라우트

AI: 설명:

사용자: 로그인 엔드포인트에 속도 제한이 없어 무차별 대입 공격에 취약합니다

AI: 필요한 조치:

사용자: IP당 분당 5회 시도로 Flask-Limiter 추가

AI: 알겠습니다. 더 있습니까? (yes로 추가, no로 계속)

사용자: no

AI: 피드백을 기반으로:
    - 3/3 수락 기준 충족
    - 코드 품질: 4/5
    - 1개 주요 문제 발견 (속도 제한)

    권장사항: CHANGES REQUESTED

    동의하십니까? (yes/no)

사용자: yes

AI: 완벽합니다. 리뷰 피드백 문서를 생성했습니다.
    [문서 표시]

    다음 중 선택하세요:
    1. 승인 및 진행
    2. 수동 편집
    3. 취소

사용자: 1

AI: ✅ WP01 리뷰 완료!

    결정: CHANGES REQUESTED
    이동됨: doing 레인
    피드백 저장됨: WP01-review-feedback.md

    [진행: 3개 중 1개 작업 리뷰됨]

    다음 작업(WP02)을 리뷰하시겠습니까? (yes/no)

사용자: yes

...
```

## 참고사항

- 리뷰 피드백 문서는 `specs/{feature}/tasks/for_review/WPxx-review-feedback.md`에 저장됩니다
- 활동 로그 항목은 WP 파일에 직접 추가됩니다
- 대화형 리뷰 프로세스는 일반적으로 작업당 3-5분 소요됩니다
- 더 빠른 일괄 리뷰를 위해서는 `/spec-mix.review`를 사용하세요

---

**명령 버전**: 1.0
**최종 업데이트**: 2025-11-18
